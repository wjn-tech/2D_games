# Design: 14 大系统深度细化设计

## 1. 挖掘与自动拾取 (Digging & Auto-pickup)
- **技术实现**：使用 Godot `TileMap` 的 `set_cell` 方法。挖掘时检测点击位置的 Tile 坐标，移除 Tile 并触发 `LootSpawner`。
- **挖掘等级 (Pickaxe Power)**：每个 Tile 拥有 `required_power` 属性。玩家工具需满足 `power >= required_power` 才能挖掘。
- **自动拾取**：掉落物（RigidBody2D 或 Area2D）在生成后，若玩家在一定范围内，使用 `lerp` 或 `move_toward` 向玩家平滑移动，碰撞后进入背包。

## 2. 工业电路系统 (Industrial Circuits)
- **逻辑模型**：基于“生产者-传输者-消费者”模型。
- **组件**：
    - **电源**：产生能量信号。
    - **导线**：传输信号（可视化连线）。
    - **简单逻辑门**：实现 AND, OR, NOT 基础逻辑节点。
    - **执行器**：门、灯、陷阱、自动合成机。

## 3. 血脉与转生 (Lineage & Reincarnation)
- **遗传算法**：子嗣属性 = (父属性 + 母属性) / 2 * (1 + 随机扰动) + 培养加成。
- **成长期 (Growth Period)**：后代生成后进入“幼年期”，需经过一定游戏天数或消耗资源培养后才能转为“成年期”并可被选为转生对象。
- **NPC 性格**：NPC 拥有固定的性格标签（如：勇敢、贪婪、温和），影响交互成功率与后代初始属性。
- **转生流程**：
    1. 玩家死亡/寿命尽。
    2. 弹出子嗣选择界面（仅限已成年的子嗣）。
    3. 将选中的子嗣数据覆盖到 `Player` 节点。
    4. 遍历原背包，保留“装备”类物品，清除消耗品（或按比例保留）。

## 4. 阵法系统 (Formations)
- **动态阵法 (Dynamic)**：以玩家为中心的移动区域，随玩家移动，影响范围内友军的属性或行为。
- **静态阵法 (Static)**：布置在地面上的固定区域（陷阱或增益阵），触发后产生持续效果。
- **视觉**：使用 `GPUParticles2D` 或 `Line2D` 绘制阵法纹路。

## 5. 战斗与弹药 (Combat & Ammo)
- **通用弹药系统**：远程武器消耗通用类型的弹药（如：箭矢、灵石）。
- **弹药附魔 (Enchantment)**：支持给弹药施加临时或永久状态（如：火属性、冰属性），在命中时触发额外效果。
- **多层战斗视觉**：切换图层时，非当前图层的物体变为半透明或暗色。

## 6. 生态系统 (Ecology)
- **资源再生**：被挖掘或采集的资源点在一定时间后自动重置/再生。
- **捕食 AI**：肉食性动物会主动寻找并攻击草食性动物，实现基础食物链模拟。
