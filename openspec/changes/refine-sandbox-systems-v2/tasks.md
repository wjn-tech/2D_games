# Tasks: 14 大系统细化子任务清单

## 1. 大世界与 NPC (World & NPC)
- [ ] 1.1 实现 NPC 基础 AI 状态机（闲逛、追逐、逃跑）。
- [ ] 1.2 实现阵营系统（好感度、敌对度）。
- [ ] 1.3 实现对话系统后端，支持根据好感度触发不同文本。

## 2. 建造与挖掘 (Building & Digging)
- [x] 2.1 实现 TileMap 挖掘逻辑（点击 Tile -> 检查工具稿力 -> 扣除耐久 -> 销毁）。
- [x] 2.2 实现掉落物自动吸附逻辑（检测范围 -> 飞向玩家）。
- [x] 2.3 实现资源自动再生计时器（销毁后在原位标记再生时间）。
- [x] 2.4 实现挖掘掉落物配置（支持通过 TileSet 自定义数据指定掉落物品）。
- [ ] 2.4 实现城邦领地逻辑（放置核心建筑 -> 划定保护区）。

## 3. 战斗与图层 (Combat & Layers)
- [ ] 3.1 实现基础伤害计算公式（攻击 - 防御）。
- [ ] 3.2 实现图层切换时的视觉遮罩效果（非活跃层变暗）。
- [ ] 3.3 实现通用弹药消耗逻辑（远程武器检查背包弹药）。
- [ ] 3.4 实现弹药附魔系统（给弹药 Resource 增加状态修饰符）。

## 4. 婚姻与繁育 (Marriage & Lineage)
- [ ] 4.1 实现求婚逻辑（赠送特定物品 -> 判定好感度与性格匹配）。
- [ ] 4.2 实现子嗣生成算法（属性遗传、随机天赋）。
- [ ] 4.3 实现子嗣成长期逻辑（计时器控制从幼年到成年的转变）。
- [ ] 4.4 实现子嗣培养界面逻辑（分配资源提升属性）。

## 5. 寿命与继承 (Life & Inheritance)
- [ ] 5.1 实现时间流逝导致寿命减少的逻辑。
- [ ] 5.2 实现死亡转生界面（仅列出已成年的子嗣及其属性）。
- [ ] 5.3 实现装备保留逻辑（转生后自动穿戴原身装备）。

## 6. 制造与采集 (Crafting & Gathering)
- [ ] 6.1 实现工具等级校验（如：铁镐才能挖金矿）。
- [ ] 6.2 实现炼药系统（多种材料合成 Buff 药水）。
- [ ] 6.3 实现武器锻造（加入稀有材料提升随机属性）。

## 7. 交易与经济 (Trade & Economy)
- [ ] 7.1 实现货币系统（金币作为基础物品）。
- [ ] 7.2 实现商人库存自动刷新逻辑。

## 8. 天气与生态 (Weather & Ecology)
- [ ] 8.1 实现天气对玩家属性的影响（如下雨减速、雷雨增加雷伤）。
- [ ] 8.2 实现植物生长逻辑（随时间改变 Tile 或生成采集物）。
- [ ] 8.3 实现动物捕食 AI（检测范围内猎物 -> 追逐攻击）。

## 9. 阵法与工业 (Formations & Industry)
- [ ] 9.1 实现动态阵法（跟随玩家的 Area2D Buff 区域）。
- [ ] 9.2 实现静态阵法（放置在地面上的陷阱/增益节点）。
- [ ] 9.3 实现基础电路节点（电源、导线、AND/OR/NOT 逻辑门）。
- [ ] 9.4 实现工业机器（如：自动采矿机，需通电运行）。
